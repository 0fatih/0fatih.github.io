I"r<p>Bu yazÄ±da iÅŸleyeceÄŸimiz konu: HTTP Ä°stek BÃ¶lme saldÄ±rÄ±sÄ±. SÄ±radan basit bir HTTP isteÄŸi, aÅŸaÄŸÄ±daki ÅŸekilde olacaktÄ±r.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      GET / HTTP/1.1
      Host: fatihfurkan.site
</code></pre></div></div>

<p>Burada odaklanmamÄ±z gereken kÄ±sÄ±m, satÄ±rlarÄ±n birbirinden nasÄ±l ayrÄ±ldÄ±ÄŸÄ±. Bize gÃ¶rÃ¼nmeyen kÄ±sÄ±mda CR/LF (Carriage Return/Line Feed) karakterleri vardÄ±r. Bu karakterler HTTPâ€™de, o satÄ±rÄ±n bitip, yeni bir satÄ±rÄ±n baÅŸladÄ±ÄŸÄ±nÄ± belirtir. EÄŸer, bu karakterlerden iki tane varsa (%0d%0a%0d%0a), headerÄ±n bitip, bodynin baÅŸladÄ±ÄŸÄ±nÄ± anlarÄ±z.  Normal gÃ¶sterimleri â€œ\r\nâ€ dir. Ancak HTTP istek ve yanÄ±tlarÄ±nda URL Encode biÃ§imi kullanÄ±ldÄ±ÄŸÄ± iÃ§in, bu karakterleri daha Ã§ok %0d%0a ÅŸeklinde gÃ¶receÄŸiz.</p>

<p>BirkaÃ§ temel bilgiden sonra, asÄ±l konumuza dÃ¶nebiliriz. HTTP Response Splitting aÃ§Ä±ÄŸÄ±ndan faydalanabilmemiz iÃ§in, siteye verdiÄŸimiz herhangi bir girdinin, headerda gÃ¶nderilmesi gerekir. Ã–rneÄŸin; ismimizi isteyen bir siteye ismimizi girdiÄŸimizde, X-For-Name adlÄ± bir baÅŸlÄ±k ile gÃ¶ndersin. Yani isteÄŸimiz,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      GET / HTTP/1.1
      Host: fatihfurkan.site
      X-For-Name: Ceren
</code></pre></div></div>

<p>ÅŸeklinde gÃ¶zÃ¼ksÃ¼n. Ä°steÄŸimizde, Cerenâ€™in yanÄ±na, %0d%0aContent- Length:%200%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2019%0d%0a%0d%0a&lt;html&gt;Attack&lt;/html&gt;  ekleyerek bir saldÄ±rÄ± gerÃ§ekleÅŸtirmiÅŸ oluruz. Tabii burada hedef sitenin bahsi geÃ§en aÃ§Ä±ÄŸa karÅŸÄ± zaaflÄ± olduÄŸunu varsayÄ±yoruz.</p>

<p>YazdÄ±ÄŸÄ±mÄ±z ÅŸeyi parÃ§a parÃ§a ele alalÄ±m. Ã–ncelikle isteÄŸimizdeki her %0d%0aâ€™yÄ± \r\nâ€™e dÃ¶nÃ¼ÅŸtÃ¼rerek, okunabilirliÄŸi arttÄ±ralÄ±m: \r\nContent-Length:%200\r\n\r\nHTTP/1.1%20200%20OK\r\nContent-Type:%20text/html\r\nContent-Length:%2019\r\n\r\n&lt;html&gt;Attack&lt;/html&gt;</p>

<p>Daha gÃ¼zel oldu. Bir de \r\nâ€™lerin gÃ¶revi olan, satÄ±r atlamayÄ± ve URL Encodeâ€™da %20â€™nin karÅŸÄ±lÄ±ÄŸÄ± olan boÅŸluk ifadesini de yerlerine koyarak aÅŸaÄŸÄ±daki sonucu elde edelim.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      GET / HTTP/1.1
      Host: fatihfurkan.site
      X-For-Name: Ceren
      Content-Length: 0

      HTTP/1.1 200 OK
      Content-Type: text/html
      Content-Length: 19

      &lt;html&gt;Attack&lt;/html&gt;
</code></pre></div></div>

<p>O kadar da karmaÅŸÄ±k bir ÅŸey deÄŸilmiÅŸ deÄŸil mi? Åimdi, bu isteÄŸin ne yaptÄ±ÄŸÄ±nÄ± satÄ±r satÄ±r inceleyelim.</p>

<p>1) GET ile kÃ¶k dizinini istediÄŸimizi ve bu isteÄŸi HTTP protokolÃ¼nÃ¼n 1.1 versiyonu Ã¼stÃ¼nden istediÄŸimizi,</p>

<p>2) Bu isteÄŸin, fatihfurkan.site adlÄ± siteye gÃ¶nderildiÄŸini,</p>

<p>3) Ä°smimizi Ceren olarak girdiÄŸimizi,</p>

<p>4) Ä°Ã§erik uzunluÄŸunun 0 olduÄŸunu (Ã§Ã¼nkÃ¼ isteÄŸimizde, headerdaki ismimiz hariÃ§ hiÃ§bir iÃ§erik gÃ¶ndermiyoruz),</p>

<p>5) Header kÄ±smÄ±nÄ±n bitip, body kÄ±smÄ±nÄ±n baÅŸladÄ±ÄŸÄ±nÄ± belirtiyoruz.</p>

<p>6) Burada, iÃ§erik uzunluÄŸunu 0 girmemize raÄŸmen bir ÅŸeyler yazÄ±yoruz. Bunun sebebi, sunucunun bu kÄ±smÄ±, isteÄŸimizin bir parÃ§asÄ± olarak deÄŸil de baÅŸka bir istek/yanÄ±t olarak gÃ¶rmesini saÄŸlamak. EÄŸer amacÄ±mÄ±za ulaÅŸmÄ±ÅŸsak, sunucu, metnin yapÄ±sÄ±ndan Ã¶tÃ¼rÃ¼ bunu bir yanÄ±t olarak algÄ±layacaktÄ±r. YanÄ±tÄ±mÄ±zÄ±n ilk satÄ±rÄ±nda bu yanÄ±tÄ±n, HTTP 1.1 versiyonu ile gÃ¶nderildiÄŸini ve baÅŸarÄ±lÄ± bir istek olduÄŸunu gÃ¶rebiliriz.</p>

<p>7) YanÄ±tÄ±mÄ±zÄ±n iÃ§erik tÃ¼rÃ¼nÃ¼n, text/html olduÄŸunu,</p>

<p>8) YanÄ±tÄ±mÄ±zÄ±n iÃ§erik uzunluÄŸunun 19 olduÄŸunu,</p>

<p>9) Header kÄ±smÄ±nÄ±n bitip, body kÄ±smÄ±nÄ±n baÅŸladÄ±ÄŸÄ±nÄ± belirtiyoruz.</p>

<p>10) Buraya ne istersek yazabiliriz. Ã‡Ã¼nkÃ¼ bu kÄ±sÄ±m, saldÄ±rÄ± baÅŸarÄ±lÄ± olduÄŸunda Ã§alÄ±ÅŸacak kÄ±sÄ±mdÄ±r.</p>

<p>Ä°steÄŸimizi aÃ§Ä±kladÄ±ÄŸÄ±mÄ±za gÃ¶re, bunun Ã§alÄ±ÅŸma mantÄ±ÄŸÄ±na geÃ§elim.</p>

<p>Biz, iÃ§erik uzunluÄŸu 0 olan bir istek gÃ¶nderiyoruz ve yanÄ±tÄ±mÄ±zÄ± alÄ±yoruz. Bir istek - bir sonuÃ§ deÄŸil mi? Peki ya isteÄŸimizle beraber gÃ¶nderdiÄŸimiz yanÄ±ta ne oldu? Sunucu, bir istek - bir sonuÃ§ politikasÄ±na gÃ¶re, o yanÄ±tÄ± bir isteÄŸe gÃ¶ndermeli. Sunucu bu durumda ilginÃ§tir ki, kendisine gelen ilk isteÄŸe bu yanÄ±tÄ± dÃ¶ndÃ¼recektir. Bunun sonucunda, bizden sonraki isteÄŸi gÃ¶nderen kiÅŸi, asÄ±l istediÄŸi yanÄ±tÄ± deÄŸil de bizim gÃ¶nderdiÄŸimizi alacaktÄ±r. Biraz daha anlaÅŸÄ±lÄ±r olmasÄ± iÃ§in ÅŸÃ¶yle aÃ§Ä±klayayÄ±m.</p>

<p>a) SaldÄ±rgan, iÃ§erisinde CRLF karakterleri ile ayrÄ±lmÄ±ÅŸ bir istek ve bir yanÄ±t bulunan, isteÄŸi gÃ¶nderir.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      GET / HTTP/1.1
      Host: fatihfurkan.site
      X-For-Name: Ceren
      Content-Length: 0

      HTTP/1.1 200 OK
      Content-Type: text/html
      Content-Length: 19

      &lt;html&gt;Attack&lt;/html&gt;
</code></pre></div></div>

<p>b) Bu istek fatihfurkan.site aldÄ± siteye gidecektir. Ama Ã¶nemli olan; bunu bir proxy serverdan geÃ§erek yapmasÄ±dÄ±r. Ä°lk istek proxy server tarafÄ±ndan, aradÄ±ÄŸÄ± yanÄ±tÄ± alÄ±r. Ancak gÃ¶ndermiÅŸ olduÄŸumuz yanÄ±t, herhangi bir istek ile eÅŸleÅŸmediÄŸi iÃ§in askÄ±da kalÄ±r.</p>

<p>c) Ä°lk isteÄŸi gÃ¶nderdikten hemen sonra, saldÄ±rganÄ±n yeni bir istek gÃ¶nderdiÄŸini varsayalÄ±m.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      GET /blog HTTP/1.1
      Host: fatihfurkan.site
</code></pre></div></div>

<p>d) Proxy server /blog iÃ§in gelen isteÄŸi gÃ¶rdÃ¼ÄŸÃ¼nde, bu isteÄŸe karÅŸÄ±lÄ±k, bizim gÃ¶nderdiÄŸimiz yanÄ±tÄ± verir. Peki bu sadece saldÄ±rgan iÃ§in mi geÃ§erli? Elbette hayÄ±r! YanÄ±tÄ±mÄ±zÄ± sunucuda askÄ± durumuna dÃ¼ÅŸÃ¼rdÃ¼kten sonra, sunucu kendisine gelen ilk isteÄŸe, kimin gÃ¶nderdiÄŸine bakmaksÄ±zÄ±n, bizim yanÄ±tÄ±mÄ±zÄ± dÃ¶ndÃ¼recektir. Ve eÄŸer biz bu isteÄŸimizi proxy serverâ€™Ä±n Ã¶n belleÄŸine girdirebilirsek, Ã¶n bellek sÃ¼resi bitene kadar o siteye girmek iÃ§in gelen her isteÄŸe bizim yanÄ±tÄ±mÄ±z dÃ¶necektir.</p>

<p>Her ne kadar heyecan verici bir saldÄ±rÄ± olsa da, sanÄ±rÄ±m kendimizi kurban durumunda dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼mÃ¼zde, o heyecanÄ±n yerini endiÅŸe alacaktÄ±r.</p>

<p><strong>Fatih Furkan HatipoÄŸlu</strong></p>

<p>Â </p>

<p>Bana bu kadar bilgi yetmez, daha fazlasÄ±nÄ± istiyorum diyenler iÃ§in birkaÃ§ tavsiye kaynak:</p>

<p><a href="https://www.netsparker.com.tr/blog/web-guvenligi/crlf-injection-ve-http-response-splitting-zafiyeti/"> Netsparker - CRLF Injection ve HTTP Response Splitting Zafiyeti </a></p>

<p><a href="https://www.cs.montana.edu/courses/csci476/topics/http_response_splitting.pdf"> Montana Ãœniversitesi - HTTP Response Splitting (slayt) </a></p>

<p><a href="https://resources.infosecinstitute.com/http-response-splitting-attack/"> InfosecInstitute - HTTP Response Splitting Attack </a></p>
:ET